// import React from 'react';
// import { Link } from 'react-router-dom';
// import workshop1 from './Images/Gathered youth.jpg';
// import workshop2 from './Images/Gal on mic.jpg';
// import workshop3 from './Images/youth joint.jpg';
// import workshop4 from './Images/LifeSkills.jpg';
// import Footer from './Footer';

// const Workshops = () => {
//   return (
//     <div className="" style={{ marginTop: '150px' }} id='workshops'>
//       <div className="text-center mb-5">
//         <h2 className="fw-bold text-uppercase" style={{ color: '#992525' }}>Community Workshops</h2>
//         <p className="text-muted">Interactive sessions that inspire, educate, and empower our communities.</p>
//       </div>

//       <div className="row g-4">
//         {/* Workshop 1 */}
//         <div className="col-md-6 col-lg-3" style={{marginLeft:'150px'}}>
//           <div className="card h-100 shadow-sm border-0">
//             <img src={workshop1} className="card-img-top" alt="Mentorship Workshop" />
//             <div className="card-body">
//               <h5 className="card-title fw-bold" style={{ color: '#992525' }}>Mentorship Workshop</h5>
//               <p className="card-text">Guiding adolescents and youth through one-on-one and group mentorship programs.</p>
//             </div>
//           </div>
//         </div>

//         {/* Workshop 2 */}
//         <div className="col-md-6 col-lg-3" style={{marginLeft:'50px'}}>
//           <div className="card h-100 shadow-sm border-0">
//             <img src={workshop2} className="card-img-top" alt="Youth Dialogue" />
//             <div className="card-body">
//               <h5 className="card-title fw-bold" style={{ color: '#992525' }}>Youth Dialogue</h5>
//               <p className="card-text">Open forums for youth to express, share experiences, and co-create solutions.</p>
//             </div>
//           </div>
//         </div>

//         {/* Workshop 3 */}
//         <div className="col-md-6 col-lg-3" style={{marginLeft:'50px'}}>
//           <div className="card h-100 shadow-sm border-0">
//             <img src={workshop3} className="card-img-top" alt="Parenting Skills Training" />
//             <div className="card-body">
//               <h5 className="card-title fw-bold" style={{ color: '#992525' }}>Parenting Skills</h5>
//               <p className="card-text">Training sessions for caregivers on nurturing, protecting, and supporting children.</p>
//             </div>
//           </div>
//         </div>

//         {/* Workshop 4 */}
//         <div className="col-md-6 col-lg-3" style={{marginLeft:'120px', marginTop:'70px'}}>
//           <div className="card h-100 shadow-sm border-0">
//             <img src={workshop4} className="card-img-top" alt="Empowerment Seminar" />
//             <div className="card-body">
//               <h5 className="card-title fw-bold" style={{ color: '#992525' }}>Empowerment Seminar</h5>
//               <p className="card-text">Equipping communities with knowledge on rights, resilience, and self-sufficiency.</p>
//             </div>
//           </div>
//         </div>
//       </div>

//       {/* CTA */}
//       <div className="text-center mt-5">
//         <h5 className="fw-bold">Want to participate or collaborate?</h5>
//         <p>We welcome partners, volunteers, and participants for our upcoming workshops.</p>
//         <Link
//           to="/join"
//           className="btn btn-outline-danger px-4 py-2"
//           style={{ borderColor: '#992525', color: '#992525' }}
//         >
//           Get in Touch
//         </Link>
//       </div>

//       <Footer />
//     </div>
//   );
// };

// export default Workshops;

// import React from 'react';
// import { Link } from 'react-router-dom';
// import workshop1 from './Images/Gathered youth.jpg';
// import workshop2 from './Images/Gal on mic.jpg';
// import workshop3 from './Images/youth joint.jpg';
// import workshop4 from './Images/LifeSkills.jpg';
// import workshop5 from './Images/women2.jpg';
// import workshop7 from './Images/women22.jpg'
// import Footer from './Footer';

// const Workshops = () => {
//   return (
//     <div className="" style={{ marginTop: '150px' }} id='workshops'>
//       <div className="text-center mb-5">
//         <h2 className="fw-bold text-uppercase" style={{ color: '#992525' }}>Community Workshops</h2>
//         <p className="text-muted">Interactive sessions that inspire, educate, and empower our communities.</p>
//       </div>

//       <div className="row g-4">
//         {/* Workshop 1 */}
//         <div className="col-md-6 col-lg-3" style={{ marginLeft: '150px' }}>
//           <div className="card h-100 shadow-sm border-0">
//             <img src={workshop1} className="card-img-top" alt="Mentorship Workshop" />
//             <div className="card-body">
//               <h5 className="card-title fw-bold" style={{ color: '#992525' }}>Mentorship Workshop</h5>
//               <p className="card-text">Guiding adolescents and youth through one-on-one and group mentorship programs.</p>
//             </div>
//           </div>
//         </div>

//         {/* Workshop 2 */}
//         <div className="col-md-6 col-lg-3" style={{ marginLeft: '50px' }}>
//           <div className="card h-100 shadow-sm border-0">
//             <img src={workshop2} className="card-img-top" alt="Youth Dialogue" />
//             <div className="card-body">
//               <h5 className="card-title fw-bold" style={{ color: '#992525' }}>Youth Dialogue</h5>
//               <p className="card-text">Open forums for youth to express, share experiences, and co-create solutions.</p>
//             </div>
//           </div>
//         </div>

//         {/* Workshop 3 */}
//         <div className="col-md-6 col-lg-3" style={{ marginLeft: '50px' }}>
//           <div className="card h-100 shadow-sm border-0">
//             <img src={workshop3} className="card-img-top" alt="Parenting Skills Training" />
//             <div className="card-body">
//               <h5 className="card-title fw-bold" style={{ color: '#992525' }}>Parenting Skills</h5>
//               <p className="card-text">Training sessions for caregivers on nurturing, protecting, and supporting children.</p>
//             </div>
//           </div>
//         </div>

//         {/* Workshop 4 */}
//         <div className="col-md-6 col-lg-3" style={{ marginLeft: '120px', marginTop: '70px' }}>
//           <div className="card h-100 shadow-sm border-0">
//             <img src={workshop4} className="card-img-top" alt="Empowerment Seminar" />
//             <div className="card-body">
//               <h5 className="card-title fw-bold" style={{ color: '#992525' }}>Empowerment Seminar</h5>
//               <p className="card-text">Equipping communities with knowledge on rights, resilience, and self-sufficiency.</p>
//             </div>
//           </div>
//         </div>

//         {/* Workshop 5 - Women Empowerment */}
//         <div className="col-md-6 col-lg-3" style={{ marginLeft: '50px', marginTop: '70px' }}>
//           <div className="card h-100 shadow-sm border-0">
//             <img src={workshop5} className="card-img-top" alt="Women Empowerment Workshop" />
//             <div className="card-body">
//               <h5 className="card-title fw-bold" style={{ color: '#992525' }}>Women Empowerment</h5>
//               <p className="card-text">
//                 Hands-on training in backyard gardening, knitting, tailoring, and other income-generating activities.
//               </p>
//             </div>
//           </div>
//         </div>

//         {/* Workshop 6 - Life Skills */}
//         {/* <div className="col-md-6 col-lg-3" style={{ marginLeft: '50px', marginTop: '70px' }}>
//           <div className="card h-100 shadow-sm border-0">
//             <img src={workshop6} className="card-img-top" alt="Life Skills Workshop" />
//             <div className="card-body">
//               <h5 className="card-title fw-bold" style={{ color: '#992525' }}>Life Skills Workshop</h5>
//               <p className="card-text">
//                 Training in financial literacy, communication, personal hygiene, and conflict resolution for everyday success.
//               </p>
//             </div>
//           </div>
//         </div> */}

//         {/* ðŸ”´ Workshop 7 - Women's Health & Wellness */}
//         <div className="col-md-6 col-lg-3" style={{ marginLeft: '150px', marginTop: '70px' }}>
//           <div className="card h-100 shadow-sm border-0">
//             <img src={workshop7} className="card-img-top" alt="Women's Health & Wellness" />
//             <div className="card-body">
//               <h5 className="card-title fw-bold" style={{ color: '#992525' }}>Health & Wellness</h5>
//               <p className="card-text">
//                 A holistic workshop promoting women's physical, mental, and reproductive health through expert-led sessions and open discussions.
//               </p>
//             </div>
//           </div>
//         </div>
//       </div>

//       {/* CTA */}
//       <div className="text-center mt-5">
//         <h5 className="fw-bold">Want to participate or collaborate?</h5>
//         <p>We welcome partners, volunteers, and participants for our upcoming workshops.</p>
//         <Link
//           to="/join"
//           className="btn btn-outline-danger px-4 py-2"
//           style={{ borderColor: '#992525', color: '#992525' }}
//         >
//           Get in Touch
//         </Link>
//       </div>

//       <Footer />
//     </div>
//   );
// };

// export default Workshops;

import React, { useState, useEffect, useCallback } from "react";
import { Link } from "react-router-dom";
import { Container, Card, Row, Col, Spinner, Alert } from "react-bootstrap";
import Footer from "./Footer";
import { authenticatedFetch } from "../Dashboard/Content/Latest/authService";

const Workshops = () => {
    const API_BASE_URL = process.env.REACT_APP_API_URL;
    const [workshops, setWorkshops] = useState([]);
    const [pageContent, setPageContent] = useState({
        title: "",
        description: "",
        cta_header: "",
        cta_text: "",
        cta_button_text: "",
    });
    const [loading, setLoading] = useState(true);
    const [error, setError] = useState("");

    const fetchWorkshops = useCallback(async () => {
        setLoading(true);
        setError("");
        try {
            const res = await authenticatedFetch(`${API_BASE_URL}/api/v1/workshops/`, { method: "GET" });
            const data = await res.json();
            if (res.ok) {
                setWorkshops(data.workshops);
                setPageContent(data.page_content);
            } else {
                setError(data.error || "Failed to fetch workshops");
            }
        } catch (err) {
            console.error(err);
            setError("Network error. Check backend connection.");
        } finally {
            setLoading(false);
        }
    }, []);

    useEffect(() => {
        fetchWorkshops();
    }, [fetchWorkshops]);

    if (loading) {
        return (
            <Container className="d-flex justify-content-center align-items-center" style={{ minHeight: "80vh" }}>
                <Spinner animation="border" role="status">
                    <span className="visually-hidden">Loading...</span>
                </Spinner>
            </Container>
        );
    }

    if (error) {
        return (
            <Container className="d-flex justify-content-center align-items-center" style={{ minHeight: "80vh" }}>
                <Alert variant="danger" className="text-center">
                    {error}
                </Alert>
            </Container>
        );
    }

    return (
        <div className="" style={{ marginTop: '150px' }} id='workshops'>
            <Container>
                <div className="text-center mb-5">
                    <h2 className="fw-bold text-uppercase" style={{ color: '#992525' }}>{pageContent.title}</h2>
                    <p className="text-muted">{pageContent.description}</p>
                </div>

                <Row xs={1} md={2} lg={3} className="g-4 justify-content-center">
                    {workshops.length > 0 ? (
                        workshops.map((workshop) => (
                            <Col key={workshop.id} className="d-flex">
                                <Card className="h-100 shadow-sm border-0">
                                    <Card.Img
                                        variant="top"
                                        src={`${API_BASE_URL}/${workshop.image}`}
                                        alt={workshop.title}
                                        onError={(e) => {
                                            e.target.onerror = null;
                                            e.target.src = "https://via.placeholder.com/400x300.png?text=Image+Not+Found";
                                        }}
                                    />
                                    <Card.Body>
                                        <Card.Title className="fw-bold" style={{ color: '#992525' }}>{workshop.title}</Card.Title>
                                        <Card.Text>{workshop.description}</Card.Text>
                                    </Card.Body>
                                </Card>
                            </Col>
                        ))
                    ) : (
                        <Col xs={12} className="text-center">
                            <p className="text-muted">No workshops available at the moment. Please check back later!</p>
                        </Col>
                    )}
                </Row>

                {/* --- Dynamically consumed CTA Section --- */}
                <div className="text-center mt-5">
                    <h5 className="fw-bold">{pageContent.cta_header}</h5>
                    <p>{pageContent.cta_text}</p>
                    <Link
                        to="/join"
                        className="btn btn-outline-danger px-4 py-2"
                        style={{ borderColor: '#992525', color: '#992525' }}
                    >
                        {pageContent.cta_button_text}
                    </Link>
                </div>
            </Container>
            <Footer />
        </div>
    );
};

export default Workshops;